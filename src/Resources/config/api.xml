<?xml version="1.0" ?>

<container xmlns="http://symfony.com/schema/dic/services"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">
    <services>
        <service id="SimplyStream\TwitchApiBundle\Helix\EventSub\EventSubService">
            <argument type="service" id="httplug.client">~</argument>
            <argument type="service" id="httplug.psr17_request_factory">~</argument>
            <argument type="service" id="httplug.psr17_stream_factory">~</argument>
            <argument type="service" id="jms_serializer">~</argument>
            <argument type="service" id="SimplyStream\TwitchApiBundle\Helix\Authentication\Provider\TwitchProvider">
                ~
            </argument>
            <argument type="abstract">~</argument>
        </service>

        <service id="SimplyStream\TwitchApiBundle\Helix\Api\TwitchApiService">
            <argument type="service" id="httplug.client">~</argument>
            <argument type="service" id="httplug.psr17_request_factory">~</argument>
            <argument type="service" id="SimplyStream\TwitchApiBundle\Helix\Authentication\Provider\TwitchProvider">
                ~
            </argument>
            <argument type="service" id="jms_serializer">~</argument>
            <argument type="service" id="httplug.psr17_stream_factory">~</argument>
            <argument type="abstract">~</argument>
        </service>

        <service id="simplystream_twitch_api.serializer.twitch_response_handler"
                 class="SimplyStream\TwitchApiBundle\Serializer\TwitchResponseHandler">
            <argument type="service" id="jms_serializer.object_constructor"/>
            <argument type="service" id="jms_serializer.accessor_strategy"/>

            <tag name="jms_serializer.handler"
                 type="SimplyStream\TwitchApiBundle\Helix\Dto\TwitchResponse"
                 format="json"/>
        </service>

        <service id="simplystream_twitch_api.serializer.eventsub_response_handler"
                 class="SimplyStream\TwitchApiBundle\Serializer\TwitchResponseHandler">
            <argument type="service" id="jms_serializer.object_constructor"/>
            <argument type="service" id="jms_serializer.accessor_strategy"/>

            <tag name="jms_serializer.handler"
                 type="SimplyStream\TwitchApiBundle\Helix\EventSub\Dto\EventResponse"
                 method="deserializeTwitchResponseFromjson"
                 format="json"/>
        </service>

        <service id="simplystream_twitch_api.serializer.subscription_response_handler"
                 class="SimplyStream\TwitchApiBundle\Serializer\TwitchResponseHandler">
            <argument type="service" id="jms_serializer.object_constructor"/>
            <argument type="service" id="jms_serializer.accessor_strategy"/>

            <tag name="jms_serializer.handler"
                 type="SimplyStream\TwitchApiBundle\Helix\EventSub\Dto\Subscription"
                 method="deserializeTwitchResponseFromjson"
                 format="json"/>
        </service>

        <service id="SimplyStream\TwitchApiBundle\Helix\EventSub\Factories\ConditionFactory"/>
        <service id="SimplyStream\TwitchApiBundle\Helix\Authentication\Token\Storage\InMemoryStorage"/>
    </services>
</container>
